import{t as e}from"./index-024a9c48.js";import{r as a}from"./service-7a3c1632.js";import{u as t}from"./usePagination-86566be3.js";import{H as l,g as n,i as r,R as s,Q as i,K as o,_ as u,r as d,o as p,a as c,k as g,l as f,b as h,F as m,A as y,y as _,z as D,d as C,e as v}from"./index-6ec14de9.js";const T={class:"app-container"},b={class:"custom-main-contents visit-left-contents",ref:"mainRef"},x={class:"flex-1 flex flex-column"},S={key:0},I={class:"pager-wrapper mt20"},R={class:"visit-right-contents"},k={class:"basic-header"},E={key:1,class:"flex flex-1 flex-row justify-center"};const L=u({setup(){const{proxy:u}=l();let d=n({height:500,searchData:{uuId:"",categorys:["PAGE_CHANGE","USER_CLICK","HTTP_LOG","JS_ERROR"],data:e({format:["00:00:00","23:59:59"]})},categoryOptions:[{value:"PAGE_CHANGE",label:"用户浏览"},{value:"USER_CLICK",label:"用户点击"},{value:"HTTP_LOG",label:"用户请求"},{value:"JS_ERROR",label:"JS错误"}],pageDetail:{},userList:[]});const{paginationData:p,handleCurrentChange:c,handleSizeChange:g}=t((()=>{f()})),f=async()=>{if(!d.searchData.uuId||!d.searchData.categorys)return void o(d.searchData.uuId?"请选择事件类型":"请输入用户ID");let e={uuId:d.searchData.uuId,categorys:d.searchData.categorys,startTime:d.searchData.data[0],endTime:d.searchData.data[1],page:p.currentPage,pageSize:p.pageSize},t=await function(e){return a({url:"/adm/get/user/behavior",method:"post",data:e})}(e);t.success?(d.pageDetail=t.model.pageDetail||{},d.userList=t.model.userList||[],p.total=t.model.count):d.pageDetail={}},h=async()=>{p.currentPage=1,p.pageSize=10,f()},m=r(null);return s((()=>{const{obj:e}=u.$route.query;if(e){const a=JSON.parse(e);d.searchData.uuId=a.uuId,d.searchData.data=[a.startTime,a.endTime]}i((()=>{d.height=m.value.offsetHeight-100})),h()})),{data:d,init:h,resetSearch:()=>{},paginationData:p,handleCurrentChange:c,handleSizeChange:g,mainRef:m}}},[["render",function(e,a,t,l,n,r){const s=d("el-input"),i=d("el-form-item"),o=d("el-option"),u=d("el-select"),L=d("el-date-picker"),P=d("el-button"),z=d("el-form"),G=d("el-card"),H=d("el-timeline-item"),A=d("el-timeline"),O=d("el-scrollbar"),U=d("el-pagination"),w=d("el-col"),N=d("el-row"),V=d("el-empty");return p(),c("div",T,[g(G,{class:"search-wrapper"},{default:f((()=>[g(z,{ref:"searchFormRef",inline:!0,model:l.data.searchData},{default:f((()=>[g(i,{prop:"uuId",label:"用户Id"},{default:f((()=>[g(s,{modelValue:l.data.searchData.uuId,"onUpdate:modelValue":a[0]||(a[0]=e=>l.data.searchData.uuId=e),placeholder:"请输入用户ID"},null,8,["modelValue"])])),_:1}),g(i,{prop:"categorys",label:"事件类型"},{default:f((()=>[g(u,{modelValue:l.data.searchData.categorys,"onUpdate:modelValue":a[1]||(a[1]=e=>l.data.searchData.categorys=e),multiple:"",placeholder:"请选择事件类型",style:{width:"400px"}},{default:f((()=>[(p(!0),c(m,null,y(l.data.categoryOptions,(e=>(p(),C(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(i,{prop:"phone",label:"日期"},{default:f((()=>[g(L,{modelValue:l.data.searchData.data,"onUpdate:modelValue":a[2]||(a[2]=e=>l.data.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),g(i,null,{default:f((()=>[g(P,{type:"primary",onClick:l.init},{default:f((()=>[_("查询")])),_:1},8,["onClick"]),g(P,{onClick:l.resetSearch},{default:f((()=>[_("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),h("section",b,[l.data.userList&&l.data.userList.length>0?(p(),c(m,{key:0},[g(G,{class:"flex flex-1 flex-column visit-left-list"},{default:f((()=>[h("div",x,[g(O,{"max-height":`${l.data.height}px`,style:{flex:"1"}},{default:f((()=>[g(A,null,{default:f((()=>[(p(!0),c(m,null,y(l.data.userList,((e,a)=>(p(),C(H,{icon:"USER_CLICK"==e.category?"Pointer":"HTTP_LOG"==e.category?"Position":"PAGE_CHANGE"==e.category?"Files":"JS_ERROR"==e.category?"CircleClose":"",center:"",timestamp:e.happenTime,placement:"top",key:a},{default:f((()=>[g(G,{style:{width:"95%"}},{default:f((()=>["USER_CLICK"==e.category?(p(),c(m,{key:0},[h("p",null,D(e.subType),1),h("p",null,"pageUrl: "+D(e.pageUrl),1),h("p",null,"tagName: "+D(e.tagName),1),h("p",null,"innerHTML: "+D(e.innerHTML),1)],64)):v("",!0),"HTTP_LOG"==e.category?(p(),c(m,{key:1},[h("p",null,D(e.subType)+"请求方式: "+D(e.method)+" 请求方式:"+D(e.type)+" 接口状态: "+D(e.status)+" 耗时:"+D(e.duration)+" ms ",1),h("p",null,"pageUrl: "+D(e.pageUrl),1),h("p",null,"pathName: "+D(e.pathName),1),h("p",null,"requestText: "+D(e.requestText),1),h("p",null,"responseText: "+D(e.responseText),1)],64)):v("",!0),"PAGE_CHANGE"==e.category?(p(),c(m,{key:2},[h("p",null,[_(D(e.subType)+" ",1),e.duration?(p(),c("span",S,"停留:"+D(e.duration)+"ms",1)):v("",!0)]),h("p",null,"referrer: "+D(e.referrer),1),h("p",null,"from: "+D(e.from),1),h("p",null,"to: "+D(e.to),1)],64)):v("",!0),"JS_ERROR"==e.category?(p(),c(m,{key:3},[h("p",null,D(e.subType),1),h("p",null,D(e.errorMsg),1)],64)):v("",!0)])),_:2},1024)])),_:2},1032,["icon","timestamp"])))),128))])),_:1})])),_:1},8,["max-height"]),h("div",I,[g(U,{background:"",layout:l.paginationData.layout,"page-sizes":l.paginationData.pageSizes,total:l.paginationData.total,"page-size":l.paginationData.pageSize,currentPage:l.paginationData.currentPage,onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])])),_:1}),h("div",R,[h("div",k,[g(N,null,{default:f((()=>[g(w,{span:12},{default:f((()=>[_("cip： "+D(l.data.pageDetail.ip),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("cregion： "+D(l.data.pageDetail.country),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("deviceType： "+D(l.data.pageDetail.deviceType),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("os： "+D(l.data.pageDetail.os),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("browserInfo： "+D(l.data.pageDetail.browserInfo),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("device： "+D(l.data.pageDetail.device),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("deviceModel： "+D(l.data.pageDetail.deviceModel),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("language： "+D(l.data.pageDetail.language),1)])),_:1}),g(w,{span:12},{default:f((()=>[_("netWork： "+D(l.data.pageDetail.netWork),1)])),_:1}),g(w,{span:12}),g(w,{span:12},{default:f((()=>[_("userAgent： "+D(l.data.pageDetail.userAgent),1)])),_:1})])),_:1})])])],64)):(p(),c("div",E,[g(V,{description:"未找到该用户记录"})]))],512)])}],["__scopeId","data-v-7fe11e25"]]);export{L as default};
//# sourceMappingURL=index-8fcac738.js.map
